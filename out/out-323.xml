<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0">
<channel>
<title>Coding Horror</title>
<description>programming and human factors</description>
<link>https://blog.codinghorror.com/</link>
<pubDate>Sun, 19 Apr 2020 00:00:01 GMT</pubDate>
<!-- other elements omitted from this example -->
<item>
<title>The Perils of FUI: Fake User Interface</title>
<link>https://blog.codinghorror.com/the-perils-of-fui-fake-user-interface/</link>
<content>
                <!--kg-card-begin: markdown--><p>
As a software developer, tell me if you've ever done this:
</p>
<p>
</p>
<ol>
<li>Taken a screenshot of something on the desktop
</li>
<li>Opened it in a graphics program
</li>
<li>Gone off to work on something else
</li>
<li>Upon returning to your computer, attempted to <b>click on the screenshot as if it was an actual program</b>.
</li>
</ol>
<p>
And let's not forget the common <a href="http://www.codinghorror.com/blog/archives/000997.html">goating</a> technique where you take a screenshot of someone's desktop, make it the desktop background, then proceed to hide every UI element on the screen. The anguished cries as users desperately double-triple-quadruple click on pixels that <i>look exactly like real user interfaces</i> can typically be heard for miles.
</p>
<p>
I bring this up to generate some sympathy. I get fooled by my own FUI -- Fake User Interface -- at least once a month. If it can happen to us, it can happen to anyone. Which means FUI can be quite dangerous in the wrong hands. Consider <a href="http://www.ctechsinc.com/">Ryan Meray's</a> story:
</p>
<p>
</p>
<blockquote>
Okay, so here's an interesting one. My girlfriend is researching stuff on lilies, so she's trying to find the website for the Michigan Regional Lily Society.
<p>
The website address is <a href="http://www.mrls.org/">http://www.mrls.org/</a>
</p>
<p>
Feel free and browse there directly, there's nothing wrong with it. But if you don't remember the URL, your first response is to Google it. We google and get this:
</p>
<p>
<a href="http://www.google.com/search?q=Michigan+Regional+Lily+Society">http://www.google.com/search?q=Michigan+Regional+Lily+Society</a>
</p>
<p>
Now, if you're in Firefox, everything is fine. You click that first result, and you get to their website, and you learn about lilies.
</p>
<p>
However, if you are using IE, be aware, you are about to have a Spyware/Virus alert.
</p>
</blockquote>
<p>
Obviously, the poor Michigian Regional Lily Society has fallen prey to website hackers. (Note that it may have been fixed by the time I'm writing this -- but I duplicated everything I'm about to show you.)
</p>
<p>
The first clever point is that <b>the website appears fine if you navigate there directly</b>. The malicious JavaScript code inserted into the page checks the referer and does something different if you arrive there via a web search engine. This means the people who own the website, and never arrive there through Google, would be scratching their heads, wondering what all the fuss is about. So the hack survives longer.
</p>
<p>
But if you do arrive at the MRLS site through a search engine, like <a href="http://www.codinghorror.com/blog/archives/000767.html">a huge percentage of the world does</a>, you're redirected to:
</p>
<p>
<code>http://scanner.antivir64.com/?aff=1050</code>
</p>
<p>
The very first thing this page does is minimize the browser (Firefox 3, in this case) and present us with this JavaScript alert:
</p>
<p>
<img alt="mls-hack-1.png" border="0" class="at-xid-6a0120a85dcdae970b0128777058f1970c" height="312" src="https://blog.codinghorror.com/content/images/uploads/2008/08/6a0120a85dcdae970b0128777058f1970c-pi.png" width="633">
</p>
<p>
I'm intentionally juxtaposing the browser and the dialog here, but the browser is way off in the very lower right corner of the display and that dialog is smack dab in the middle of the screen. It is not at all clear that the dialog originated from that web page. It's a primitive technique, but it is surprisingly effective.
</p>
<p>
I didn't have the guts to click OK on that dialog; I clicked the close button. The browser then expanded to show this convincing "real time virus scan".
</p>
<p>
<img alt="mls-hack-2" border="0" class="at-xid-6a0120a85dcdae970b012877705916970c" height="602" src="https://blog.codinghorror.com/content/images/uploads/2008/08/6a0120a85dcdae970b012877705916970c-pi.png" width="825">
</p>
<p>
The static screenshot does not do it justice; the scrollbar moves, the list of files fly by as they are "scanned", and the web page rather successfully simulates an ersatz UI somewhere between Windows XP and Windows Vista. Of course, <i>we</i> know this Fake User Interface is completely invalid, because it is running in the browser, not on our PC. <i>You and I</i> may understand that distinction, but what about your parents? Your wife? Your children? Your less technically savvy friends? <b>Will they understand this scary, authentic looking virus warning coming from an "encrypted secure site" is all a lie?</b>
</p>
<p>
Honestly, whose PC doesn't "run slower than normal"? Maybe I would want to know if my computer is infected with Viruses, Adware or Spyware. It's all part of the <a href="http://www.codinghorror.com/blog/archives/000929.html">culture of fear</a> that security software companies -- and let's be honest, <i>Windows</i> security software companies --  cultivate so they can rake in millions of dollars per year hawking their software. The difference here, of course, is that <b>it's increasingly difficult to tell the good guys from the bad guys</b>. That's the downside of fear as a selling point: it cuts equally well in both directions.
</p>
<p>
Woe betide the poor user who is convinced through the trickery of FUI to install this "antivirus" software. The page does its darndest to <b>convince you to run its payload executable</b>. Any click on the page, no matter where, is interpreted as a download request.
</p>
<p>
<img alt="mls-hack-3" border="0" class="at-xid-6a0120a85dcdae970b012877705941970c" height="310" src="https://blog.codinghorror.com/content/images/uploads/2008/08/6a0120a85dcdae970b012877705941970c-pi.png" width="450">
</p>
<p>
The page also attempts a drive-by download, though those have been auto-blocked for years now.
</p>
<p>
<img alt="mls-hack-4" border="0" height="92" src="http://www.codinghorror.com/blog/images/mls-hack-4.png" width="576">
</p>
<p>
It's tempting to put this down as yet another iteration of <a href="http://www.codinghorror.com/blog/archives/000852.html">phishing, the forever hack</a>. To be fair, this is exactly the sort of thing web browser phishing filters were designed to prevent. This site was already in the Firefox 3 phishing filter -- but it was not caught by the Internet Explorer 7 phishing filter, so I reported it.
</p>
<p>
<img alt="mls-hack-5" border="0" class="at-xid-6a0120a85dcdae970b012877705962970c" height="262" src="https://blog.codinghorror.com/content/images/uploads/2008/08/6a0120a85dcdae970b012877705962970c-pi.png" width="643">
</p>
<p>
I am all for phishing filters as another important line of defense, but like all distributed blacklists, they're <a href="http://www.codinghorror.com/blog/archives/001009.html">only so effective</a>.
</p>
<p>
What I'm more concerned about here is how <i>well</i> the user interface was spoofed. The browser FUI was convincing enough to even make me -- possibly the world's most jaded and cynical Windows user -- do a bit of a double-take. How do you protect naive users from cleverly designed FUI exploits like this one? Can you imagine your mother doing a web search on flowers -- <i>flowers, for God's sake</i> -- clicking on the search results to a totally legitimate website, and <b>correctly navigating the resulting maze of fake UI, spurious javascript alerts, and download dialogs?</b>
</p>
<p>
I know I can't. As much as I admire distributed phishing blacklist efforts, there's no way they can possibly keep pace with the rapid setup and teardown of hacked websites. How many compromised websites are out there? How many unsophisticated users surf the internet every day?
</p>
<p>
As always, we can lay a big part of the blame at Microsoft's doorstep for <a href="http://www.codinghorror.com/blog/archives/000891.html">not adopting the UNIX policy of non-administrator accounts for regular users</a>. But then again, if the spoofing is good enough, the FUI extra-convincing, even a Linux or OS X user could be coerced into entering their admin password for a "system security scan". Or maybe they just wanted to <a href="http://www.codinghorror.com/blog/archives/000347.html">see the dancing bunnies</a>.
</p>
<p>
And then, like Ryan, you're likely to end up with the same infected computer, and the same distraught spouse. All this for the love of a few lilies.
</p>
<p>
Short of user education, which is a neverending, continuous uphill battle -- <b>how would you combat a perfectly spoofed FUI presented to a naive user?</b>
</p>
<p>
</p>
<p></p>
<!--kg-card-end: markdown-->
            </content>
<pubDate>2008-08-17T12:00:00.000Z</pubDate>
<guid>https://blog.codinghorror.com/the-perils-of-fui-fake-user-interface/</guid>
</item>
</channel>
</rss>
