<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0">
<channel>
<title>Coding Horror</title>
<description>programming and human factors</description>
<link>https://blog.codinghorror.com/</link>
<pubDate>Sun, 19 Apr 2020 00:00:01 GMT</pubDate>
<!-- other elements omitted from this example -->
<item>
<title>Spam via SMTP Non-Delivery Reports</title>
<link>https://blog.codinghorror.com/spam-via-smtp-non-delivery-reports/</link>
<content>
                <!--kg-card-begin: markdown--><p>
I have modest email needs, so I use the default SMTP and POP3 services in Windows Server 2003. Although I have <a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;324281">email relay disabled</a>, <b>spammers are still managing to send spam through my SMTP service</b> -- via non-delivery reports!
</p>
<p>
In other words, spammers are <i>intentionally sending email messages to nonexistent email addresses on my domain</i>. Here's a representative <a href="http://www.codinghorror.com/blog/archives/000063.html">sniffer trace</a> from earlier today:
</p>
<p>
</p>
<pre>
MAIL FROM:<b>&lt;lolando@glocos.com&gt;</b>
250 2.1.0 OK
RCPT TO:<b>&lt;uucp@codinghorror.com&gt;</b>
250 2.1.5 OK
354 Start mail input
DATA
(spam email body elided)
250 2.6.0  Queued mail for delivery
<p></p>
MAIL FROM:<b>&lt;meskes@getinthepicture.com&gt;</b>
250 2.1.0 OK
RCPT TO:<b>&lt;support@codinghorror.com&gt;</b>
250 2.1.5 OK
DATA
(spam email body elided)
250 2.6.0  Queued mail for delivery
</pre>
<p>
This repeats dozens of times, with different from and to email address. <b>The person in the "from" address will get a non-delivery report from my server that includes the original spam message as an attachment</b>.
</p>
<p>
This is also known as a "Reverse NDR attack", because the non-delivery report goes to the recipient (eg, the victim) instead of the sender.
</p>
<p>
I've pored over the SMTP settings in Windows Server 2003 and I can't figure out a way to fix this. I did find this cool <a href="http://support.microsoft.com/kb/842851">STMP tar pit feature</a> which sounds appropriate -- but unfortunately, will have no effect in my case. As you can see from the above sniffer trace, the basic SMTP service is not smart enough to perfom "recipient filtering"-- to reject email for users that don't exist at the time of submission. The validation of the address occurs <i>after</i> the email delivery process begins, which is too late.
</p>
<p>
I thought about suppressing non-delivery reports entirely, but this breaks the email protocol:
</p>
<p>
</p>
<blockquote><i>
Some of you might think it would be better to simply turn off recipient filtering, rely on your 3rd party antispam product, and suppress NDRs (as spammers typically use spoofed domains anyway). This is possible but unfortunately doing so breaks <a href="http://www.faqs.org/rfcs/rfc2821.html">RFC 2821</a>, which states that a NDR must be returned if an e-mail message for an invalid recipient is accepted. In addition it also means normal users that perhaps make a typo in an e-mail address will never receive an NDR informing them of the issue.
</i></blockquote>
<p>
What I really need is some way to <b>make the default SMTP service in Windows Server 2003 reject emails for invalid recipients prior to accepting the message</b>. That, along with the built-in tarpit support, should break spammers.
</p>
<p>
I hate to buy a commercial mail server to replace the simple STMP and POP3 services provided with Windows Server 2003. But unless I can stem the tide of SMTP non-delivery report spam, I guess I'll have to.
</p>
<p>
</p>
<p></p>
<!--kg-card-end: markdown-->
            </content>
<pubDate>2006-05-07T12:00:00.000Z</pubDate>
<guid>https://blog.codinghorror.com/spam-via-smtp-non-delivery-reports/</guid>
</item>
</channel>
</rss>
