<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0">
<channel>
<title>Coding Horror</title>
<description>programming and human factors</description>
<link>https://blog.codinghorror.com/</link>
<pubDate>Sun, 19 Apr 2020 00:00:01 GMT</pubDate>
<!-- other elements omitted from this example -->
<item>
<title>The Single Most Important Virtual Machine Performance Tip</title>
<link>https://blog.codinghorror.com/the-single-most-important-virtual-machine-performance-tip/</link>
<content>
                <!--kg-card-begin: markdown--><p>
If you use virtual machines at all, you should have the single most important virtual machine performance tip committed to heart by now: <b>always run your virtual machines from a separate physical hard drive</b>:
</p>
<p>
</p>
<blockquote>
[the] biggest performance win is to put the virtual hard disks on separate disk spindles from the operating system.  The biggest performance hit in virtual machines is disk I/O. Making the VM fight with your OS and swap disk makes this issue much, much worse.  Additionally, today's USB 2.0 and firewire external hard drives run on a fast interface bus, have large buffers and spin at 7,200 rpm, as opposed to 4,200 rpm for most laptop hard drives.
</blockquote>
<p>
I've talked about <a href="http://www.codinghorror.com/blog/archives/000207.html">virtualization performance penalties</a> before, but this bears repeating. I originally read this tip at <a href="http://www.hanselman.com/blog/CommentView.aspx?guid=097ce75a-838a-4511-a858-d6de8e8e78a9">Scott's blog</a>, and I've heard it echoed in emails directly from the <a href="http://blogs.msdn.com/Virtual_PC_Guy/">Virtual PC Guy</a> himself.
</p>
<p>
It's true that most laptop drives are at 5,400 rpm these days, and a scant few even run at 7,200 rpm. But the tip is still as valid as ever. <b>The primary performance bottleneck in virtual machines, by a very wide margin, is the hard drive.</b> Although it's possible to <a href="http://www.codinghorror.com/blog/archives/000639.html">squeeze a complete install of Windows XP into a 641 megabyte VM hard drive image file</a>, most VM hard drive image files rapidly grow to multiple gigabytes. It's not unusual to see VMs end up 5 or 10 gigabytes in size. It shouldn't be too surprising that the disk subsystem has a disproportionately large impact on overall virtual machine performance.
</p>
<p>
That's one reason why all the desktop machines I build now have <b>two hard drives</b>:
</p>
<ol>
<li>A faster, smaller drive for the operating system and essential applications. You can't beat the 10,000 rpm Western Digital Raptor series for this role.
</li>
<li>A larger data drive for virtual machines and everything else.
</li>
</ol>
<p>
This way, whenever I boot up a VM, it's running from a different physical spindle than the operating system, and thus running at optimal speeds. It's also a good way to segregate your operating system and data in case you need to do a complete wipe of your operating system. And it's certainly a much safer and more practical two drive approach than <a href="http://www.codinghorror.com/blog/archives/000335.html">RAID-0 on the desktop</a>.
</p>
<p>
Unfortunately, we can't drop a second drive into our laptops. But there's another solution that works almost as well: <b>external SATA and USB2 enclosures</b>. These enclosures offer the best of both worlds: high-speed USB 2.0 interfaces for laptops, and full-speed eSATA connections for desktops.
</p>
<p>
<img alt="icydock-external.jpg" border="0" class="at-xid-6a0120a85dcdae970b0128776fe953970c" height="316" src="https://blog.codinghorror.com/content/images/uploads/2006/10/6a0120a85dcdae970b0128776fe953970c-pi.jpg" width="212">
</p>
<p>
<img alt="icydock-back.jpg" border="0" height="94" src="http://www.codinghorror.com/blog/images/icydock-back.jpg" width="425">
</p>
<p>
The <a href="http://www.silentpcreview.com/article673-page1.html">Icy Dock</a>, pictured above, is one of the best of these new enclosures. It's a bit spendy, but it's remarkably well made from mostly aluminum, with a clever locking tray mechanism. It also includes all the extras you need to connect it to your PC, including a USB 2.0 cable, an eSATA bracket, and an eSATA cable. Just add the desktop SATA drive of your choice.
</p>
<p>
I've talked about <a href="http://www.codinghorror.com/blog/archives/000673.html">the difference between USB 2.0 and full-blown SATA performance</a> before. Here's a direct comparison between a modern 250 gigabyte 7,200 rpm SATA drive in the Icy Dock (connected via USB), and my laptop's internal 100 gigabyte 5,400 rpm hard drive:
</p>
<p>
<img alt="Laptop HDD vs. IcyDock external USB 2.0 HDD" border="0" class="at-xid-6a0120a85dcdae970b0128776fe97d970c" height="411" src="https://blog.codinghorror.com/content/images/uploads/2006/10/6a0120a85dcdae970b0128776fe97d970c-pi.png" width="613">
</p>
<p>
The USB 2.0 interface is nothing to sneeze at. With a fast 7,200 rpm desktop drive mounted, it does a little better than the internal laptop drive overall, once you factor in random access times and the constant speed across the entire drive. But it's obviously limited by the interface. That's why the option to connect a drive via its native SATA interface is so desirable in an external enclosure. Some recent motherboards even include eSATA connectors on their back panel, such as the Asus P5B that I <a href="http://www.codinghorror.com/blog/archives/000697.html">recently built</a>. I presume it's only a matter of time before some enterprising laptop manufacturer releases a laptop with an eSATA connector.
</p>
<p>
It's not a slam-dunk performance victory over the internal laptop drive in absolute terms. But <b>the real-world performance improvement gained from running a VM on an external USB 2.0 drive is quite noticeable</b>. Recommended.
</p>
<p>
</p>
<p></p>
<!--kg-card-end: markdown-->
            </content>
<pubDate>2006-10-27T12:00:00.000Z</pubDate>
<guid>https://blog.codinghorror.com/the-single-most-important-virtual-machine-performance-tip/</guid>
</item>
</channel>
</rss>
