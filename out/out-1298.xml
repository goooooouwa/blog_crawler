<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0">
<channel>
<title>Coding Horror</title>
<description>programming and human factors</description>
<link>https://blog.codinghorror.com/</link>
<pubDate>Sun, 19 Apr 2020 00:00:01 GMT</pubDate>
<!-- other elements omitted from this example -->
<item>
<title>Full Threaded Shellicious</title>
<link>https://blog.codinghorror.com/full-threaded-shellicious/</link>
<content>
                <!--kg-card-begin: markdown--><p>
I couldn't resist adding some features to <a href="http://www.codinghorror.com/blog/archives/000134.html">Shellicious</a>. You can now run shell commands either asynchronously (as before) or synchronously, like so:
</p>
<p>
</p>
<pre language="vb" name="code">
Private WithEvents _s As New Shell
Private _IsExecutionComplete As Boolean = False
Public Sub Main()
<b> _s.UseNewThread = True</b>
_s.Execute("C:LongRunningConsoleApp.exe")
Do While Not _IsExecutionComplete
'-- do other work here..
Thread.Sleep(20)
Loop
Console.WriteLine("Exiting Sub Main()..")
Console.ReadLine()
End Sub
Private Sub OutputLine(ByVal LineText As String) Handles _s.OutputLine
Console.WriteLine(LineText)
End Sub
Private Sub ExecutionComplete(ByVal TimedOut As Boolean) _
Handles _s.ExecutionComplete
_IsExecutionComplete = True
Console.WriteLine("execution complete; did we time out? " &amp; TimedOut)
If _s.ExitCode &lt;&gt; 0 Then
Console.WriteLine(_s.Error)
End If
Console.WriteLine(_s.ExecutionTime)
Console.WriteLine(_s.ExitCode)
End Sub
</pre>
<p>
I updated the code <a href="http://www.codinghorror.com/blog/archives/000134.html">in the original post</a>. And this time I remembered to give the threads names, which always helps in debugging:
</p>
<p>
</p>
<pre>
The thread 'ShellErrorThread' (0xca4) has exited with code 0 (0x0).
The thread 'ShellOutputThread' (0x934) has exited with code 0 (0x0).
The thread 'ShellLaunchThread' (0x5c0) has exited with code 0 (0x0).
</pre>
<p>
So far so good. The synchronous behavior respects the same .MaximumWaitSeconds property as before, and there's a new .CancelExecution method if you want to bail out on demand.
</p>
<p>
</p>
<p></p>
<!--kg-card-end: markdown-->
            </content>
<pubDate>2004-11-22T12:00:00.000Z</pubDate>
<guid>https://blog.codinghorror.com/full-threaded-shellicious/</guid>
</item>
</channel>
</rss>
